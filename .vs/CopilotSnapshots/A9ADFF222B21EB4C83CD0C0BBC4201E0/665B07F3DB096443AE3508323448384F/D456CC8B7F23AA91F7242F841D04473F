@inject NavigationManager Navigation

<div class="sidebar webapp-sidebar">
    <div class="webapp-header">
        <div class="webapp-icon">??</div>
        <div class="webapp-info">
            <div class="webapp-name">@WebAppName</div>
            <div class="webapp-type">Web App</div>
        </div>
    </div>

    <div class="sidebar-search">
        <input type="text" placeholder="Search" class="search-input" />
    </div>

    <ul class="sidebar-menu">
        <li class="sidebar-item @(IsActive("overview") ? "active" : "")" @onclick='() => SetActiveSection("overview")'>
            <span class="sidebar-icon">??</span>
            <span>Overview</span>
        </li>
        <li class="sidebar-item @(IsActive("activity") ? "active" : "")" @onclick='() => SetActiveSection("activity")'>
            <span class="sidebar-icon">??</span>
            <span>Activity log</span>
        </li>
        <li class="sidebar-item @(IsActive("access") ? "active" : "")" @onclick='() => SetActiveSection("access")'>
            <span class="sidebar-icon">??</span>
            <span>Access control (IAM)</span>
        </li>
        <li class="sidebar-item @(IsActive("tags") ? "active" : "")" @onclick='() => SetActiveSection("tags")'>
            <span class="sidebar-icon">???</span>
            <span>Tags</span>
        </li>
        <li class="sidebar-item @(IsActive("diagnose") ? "active" : "")" @onclick='() => SetActiveSection("diagnose")'>
            <span class="sidebar-icon">??</span>
            <span>Diagnose and solve problems</span>
        </li>
        <li class="sidebar-item @(IsActive("defender") ? "active" : "")" @onclick='() => SetActiveSection("defender")'>
            <span class="sidebar-icon">???</span>
            <span>Microsoft Defender for Cloud</span>
        </li>
        <li class="sidebar-item @(IsActive("events") ? "active" : "")" @onclick='() => SetActiveSection("events")'>
            <span class="sidebar-icon">?</span>
            <span>Events (preview)</span>
        </li>
        <li class="sidebar-item @(IsActive("visualizer") ? "active" : "")" @onclick='() => SetActiveSection("visualizer")'>
            <span class="sidebar-icon">???</span>
            <span>Resource visualizer</span>
        </li>
    </ul>

    <div class="sidebar-section">
        <div class="sidebar-section-header" @onclick="ToggleDeployment">
            <span class="sidebar-icon">@(isDeploymentExpanded ? "?" : "?")</span>
            <span>Deployment</span>
        </div>
        @if (isDeploymentExpanded)
        {
            <ul class="sidebar-submenu">
                <li class="sidebar-item @(IsActive("deployment-slots") ? "active" : "")" @onclick='() => SetActiveSection("deployment-slots")'>
                    <span class="sidebar-icon">??</span>
                    <span>Deployment slots</span>
                </li>
                <li class="sidebar-item @(IsActive("deployment-center") ? "active" : "")" @onclick='() => SetActiveSection("deployment-center")'>
                    <span class="sidebar-icon">??</span>
                    <span>Deployment Center</span>
                </li>
            </ul>
        }
    </div>

    <div class="sidebar-section">
        <div class="sidebar-section-header" @onclick="ToggleSettings">
            <span class="sidebar-icon">@(isSettingsExpanded ? "?" : "?")</span>
            <span>Settings</span>
        </div>
        @if (isSettingsExpanded)
        {
            <ul class="sidebar-submenu">
                <li class="sidebar-item @(IsActive("environment") ? "active" : "")" @onclick='() => SetActiveSection("environment")'>
                    <span class="sidebar-icon">??</span>
                    <span>Environment variables</span>
                </li>
                <li class="sidebar-item @(IsActive("configuration") ? "active" : "")" @onclick='() => SetActiveSection("configuration")'>
                    <span class="sidebar-icon">??</span>
                    <span>Configuration (preview)</span>
                </li>
                <li class="sidebar-item @(IsActive("instances") ? "active" : "")" @onclick='() => SetActiveSection("instances")'>
                    <span class="sidebar-icon">???</span>
                    <span>Instances</span>
                </li>
                <li class="sidebar-item @(IsActive("authentication") ? "active" : "")" @onclick='() => SetActiveSection("authentication")'>
                    <span class="sidebar-icon">??</span>
                    <span>Authentication</span>
                </li>
                <li class="sidebar-item @(IsActive("identity") ? "active" : "")" @onclick='() => SetActiveSection("identity")'>
                    <span class="sidebar-icon">??</span>
                    <span>Identity</span>
                </li>
                <li class="sidebar-item @(IsActive("backups") ? "active" : "")" @onclick='() => SetActiveSection("backups")'>
                    <span class="sidebar-icon">??</span>
                    <span>Backups</span>
                </li>
                <li class="sidebar-item @(IsActive("custom-domains") ? "active" : "")" @onclick='() => SetActiveSection("custom-domains")'>
                    <span class="sidebar-icon">??</span>
                    <span>Custom domains</span>
                </li>
                <li class="sidebar-item @(IsActive("certificates") ? "active" : "")" @onclick='() => SetActiveSection("certificates")'>
                    <span class="sidebar-icon">??</span>
                    <span>Certificates</span>
                </li>
                <li class="sidebar-item @(IsActive("networking") ? "active" : "")" @onclick='() => SetActiveSection("networking")'>
                    <span class="sidebar-icon">??</span>
                    <span>Networking</span>
                </li>
                <li class="sidebar-item @(IsActive("webjobs") ? "active" : "")" @onclick='() => SetActiveSection("webjobs")'>
                    <span class="sidebar-icon">??</span>
                    <span>WebJobs</span>
                </li>
                <li class="sidebar-item @(IsActive("service-connector") ? "active" : "")" @onclick='() => SetActiveSection("service-connector")'>
                    <span class="sidebar-icon">??</span>
                    <span>Service Connector</span>
                </li>
                <li class="sidebar-item @(IsActive("locks") ? "active" : "")" @onclick='() => SetActiveSection("locks")'>
                    <span class="sidebar-icon">??</span>
                    <span>Locks</span>
                </li>
            </ul>
        }
    </div>

    <div class="sidebar-section">
        <div class="sidebar-section-header" @onclick="TogglePerformance">
            <span class="sidebar-icon">@(isPerformanceExpanded ? "?" : "?")</span>
            <span>Performance</span>
        </div>
        @if (isPerformanceExpanded)
        {
            <ul class="sidebar-submenu">
                <li class="sidebar-item @(IsActive("load-testing") ? "active" : "")" @onclick='() => SetActiveSection("load-testing")'>
                    <span class="sidebar-icon">??</span>
                    <span>Load Testing</span>
                </li>
            </ul>
        }
    </div>

    <div class="sidebar-section">
        <div class="sidebar-section-header" @onclick="ToggleAppServicePlan">
            <span class="sidebar-icon">@(isAppServicePlanExpanded ? "?" : "?")</span>
            <span>App Service plan</span>
        </div>
        @if (isAppServicePlanExpanded)
        {
            <ul class="sidebar-submenu">
                <li class="sidebar-item @(IsActive("app-service-plan") ? "active" : "")" @onclick='() => SetActiveSection("app-service-plan")'>
                    <span class="sidebar-icon">??</span>
                    <span>App Service plan</span>
                </li>
                <li class="sidebar-item @(IsActive("scale-up") ? "active" : "")" @onclick='() => SetActiveSection("scale-up")'>
                    <span class="sidebar-icon">??</span>
                    <span>Scale up</span>
                </li>
                <li class="sidebar-item @(IsActive("scale-out") ? "active" : "")" @onclick='() => SetActiveSection("scale-out")'>
                    <span class="sidebar-icon">??</span>
                    <span>Scale out</span>
                </li>
            </ul>
        }
    </div>
</div>

@code {
    [Parameter]
    public string WebAppName { get; set; } = "Web App";

    [Parameter]
    public string WebAppId { get; set; } = string.Empty;

    [Parameter]
    public EventCallback<string> OnSectionChanged { get; set; }

    private string activeSection = "overview";
    private bool isDeploymentExpanded = false;
    private bool isSettingsExpanded = true;
    private bool isPerformanceExpanded = false;
    private bool isAppServicePlanExpanded = false;

    private bool IsActive(string section)
    {
        return activeSection == section;
    }

    private async Task SetActiveSection(string section)
    {
        activeSection = section;
        await OnSectionChanged.InvokeAsync(section);
    }

    private void ToggleDeployment()
    {
        isDeploymentExpanded = !isDeploymentExpanded;
    }

    private void ToggleSettings()
    {
        isSettingsExpanded = !isSettingsExpanded;
    }

    private void TogglePerformance()
    {
        isPerformanceExpanded = !isPerformanceExpanded;
    }

    private void ToggleAppServicePlan()
    {
        isAppServicePlanExpanded = !isAppServicePlanExpanded;
    }
}
